\documentclass[aspectratio=169,dvipdfmx,hyperref={bookmarks=true}]{beamer}
\usepackage{graphicx}
\usepackage{url}
\usepackage{bm}
\usepackage[absolute,overlay]{textpos}
\newcommand{\thickhrulefill}{\leavevmode\leaders\hrule depth-1.2pt height 3.2pt\hfill\kern0pt}
\newcommand{\indicatewidth}[1]{\thickhrulefill{#1}\thickhrulefill}
 \usetheme{Boadilla}
 \setbeamertemplate{navigation symbols}{}
 \setbeamertemplate{footline}[page number]
 \usepackage{algorithmic}
\usepackage{algorithm}
\usepackage{comment}
\usepackage{capt-of}
%\usepackage[dvipdfmx]{hyperref} % \movieref を使う場合に必要
\usepackage[dvipdfmx]{movie15_dvipdfmx}
%\usepackage[dvipdfmx]{movie15}
\renewcommand{\kanjifamilydefault}{\gtdefault}% 既定をゴシック体に

 %\usepackage[colorgrid,gridunit=pt,texcoord]{eso-pic}
 \title{煙シミュレーションのための部分空間法の高速化}
 \author{須之内　俊樹}
 \institute{中央大学理工学研究科　情報工学専攻　\\形状情報処理研究室　23N8100018B}
 \date{2025年 2月 21日}
 \usepackage{pxjahyper}
 \begin{document}
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
   \begin{frame}
 \maketitle
 \end{frame} 
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \begin{frame}
 %\tableofcontents
% \frametitle{目次}
 %\end{frame}
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
     \section{概要}
 \begin{frame}
 \frametitle{概要}
  \begin{block}{}
  \begin{itemize}
	%\item 流体と接する製品の設計・製造，流体の映像の生成などに利用．
	\item 流体と接する製品の設計・製造
	\item 物理的に正確なシミュレーション
\end{itemize}
\end{block}

 \end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
   \section{研究背景}
 \begin{frame}
 \frametitle{研究背景}
   \framesubtitle{流体シミュレーション}
 \subsection{流体シミュレーション}
  \begin{block}{工業分野}
  \begin{itemize}
	\item 流体と接する製品の設計・製造
	\item 物理的に正確なシミュレーションが重要視
\end{itemize}
\end{block}
\begin{block}{CG分野}
\begin{itemize}
	\item 流体の映像の生成に利用
	\item 計算負荷を少なくすること，流体の挙動が制御しやすいことが重要視
	\item 物理的な正確さよりも，それらしさを重要視
\end{itemize}
\end{block}

 \begin{block}{流体シミュレーションの課題}
  \begin{itemize}
\item 希薄な流体や，水飛沫は手法によっては再現できない
\item 近年は高品質な映像が求められ，計算負荷が大きい
%\item 部分空間法による計算負荷の削減に取り組む．
\end{itemize}
\end{block}
 \end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \begin{frame}
  \frametitle{研究背景}
  \framesubtitle{流体シミュレーションの数理モデル}
    \begin{block}{ナビエ・ストークス方程式}
\[
\frac{\partial}{\partial t}\bm{u} = - (\bm{u} \boldsymbol{\cdot}\nabla) \bm{u} - \frac{1}{\rho}\nabla p + \nu\nabla^2\bm{u} + \bm{f}
\]
\[
\nabla\boldsymbol{\cdot}\bm{u} = 0
\]
\begin{itemize}
	\item $\bm{u}$，$\bm{f}$:流体の速度，外力
	\item $p$，$\rho$，$\nu$:流体の圧力，密度，粘性
	\item $\nabla = ( \frac{\partial}{\partial x}, \frac{\partial}{\partial y}, \frac{\partial}{\partial z})$
\end{itemize}
\end{block}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \begin{frame}
  \frametitle{研究背景}
  \framesubtitle{流体シミュレーションの数理モデル}

\begin{columns}[T]
	\begin{column}{0.6\linewidth}
	    \begin{block}{ナビエ・ストークス方程式の離散化}
    	\[
	\frac{\partial}{\partial t}\bm{u} = - (\bm{u} \boldsymbol{\cdot}\nabla) \bm{u} - \frac{1}{\rho}\nabla p + \nu\nabla^2\bm{u} + \bm{f}
	\]
    	\[
	\bm{u}(t + \varDelta t)  =\bm{u}(t) -\varDelta t( (\bm{u} \boldsymbol{\cdot}\nabla) \bm{u} - \frac{1}{\rho}\nabla p + \nu\nabla^2\bm{u} + \bm{f})
	\]
\end{block}
	\begin{block}{スタッガード格子}
		\begin{itemize}
		\item 速度と圧力の配置位置を工夫し，計算の安定性を向上
		\item 非直交格子への適用が困難
	\end{itemize}
	\end{block}
    	\end{column}
	\begin{column}{0.35\linewidth}
	\includegraphics[width=1.1\linewidth]{images/3dstaggerd.png}
	\label{fig:staggerd}
    	\end{column}
    \end{columns}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \begin{frame}
  \frametitle{研究背景}
  \framesubtitle{流体シミュレーションの数理モデル}
    \begin{block}{部分段階法}
    	\[
	\bm{u}(t + \varDelta t)  =\bm{u}(t) -\varDelta t( (\bm{u} \boldsymbol{\cdot}\nabla) \bm{u} - \frac{1}{\rho}\nabla p + \nu\nabla^2\bm{u} + \bm{f})
	\]
中間子$\bm{u}_0$から$\bm{u}_3$を用いて，以下のように各項ごとに分割して計算する
\begin{align*}
	\bm{u}_0				& =  \bm{u} (t)  - \varDelta t \bm{f} 				\\
	\bm{u}_1 (\bm{x}) 		&= \bm{u}_0 (\bm{x}) - \varDelta t (\bm{u}_0(\bm{x})  \boldsymbol{\cdot}\nabla) \bm{u}_0(\bm{x})	\\
	\bm{u}_2  		 		&=  \bm{u}_1 - \varDelta t \nu\nabla^2\bm{u}_1		\\
	\bm{u} (t + \varDelta t) = \bm{u}_3  &=  \bm{u}_2 - \varDelta t \frac{1}{\rho}\nabla \bm{p}
	\end{align*}
%\[
%	\bm{u}_0 =  \bm{u} (t)  - \varDelta t \bm{f} 
%\]
%\[
%	\bm{u}_1 (\bm{x}) = \bm{u}_0 (\bm{x}) - \varDelta t (\bm{u}_0(\bm{x})  \boldsymbol{\cdot}\nabla) \bm{u}_0(\bm{x})
	%\bm{u}_1(\bm{x}) = \bm{u}_0(\bm{x}  - \varDelta t \bm{u}_0)
%\]
%\[
%	\bm{u}_2   =  \bm{u}_1 - \varDelta t \nu\nabla^2\bm{u}_1
%\]
%\[
%	\bm{u} (t + \varDelta t) = \bm{u}_3  =  \bm{u}_2 - \varDelta t \frac{1}{\rho}\nabla \bm{p} 
%\]
\end{block}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \begin{frame}
  \frametitle{研究背景}
  \framesubtitle{流体シミュレーションの数理モデル}
    \begin{block}{部分段階法}
\begin{align}
	\bm{u}_0	& =  \bm{u} (t)  - \varDelta t \bm{f}\notag \\ 
	\bm{u}_1(\bm{x}) 	&= \bm{u}_0(\bm{x}  - \varDelta t \bm{u}_0)\label{eq:semi-Lagrangian}\\
%\end{align*}
%\begin{align*}
	\bm{u}_2   		&=  \bm{V}\bm{u}_1		\notag\\
	\bm{b} 			&= \bm{W}\bm{u}_2		\label{eq:v2p}	\\ 
	\bm{p} 			&= \bm{A}^{-1}\bm{b}	\label{eq:poisson} \\ 
	\bm{u} (t + \varDelta t) = \bm{u}_3  	&=  \bm{u}_2 - \bm{Y}\bm{p}\notag
\end{align}
\begin{itemize}
\item 式\ref{eq:semi-Lagrangian}はsemi-Lagrangian法\cite{stam}，式\ref{eq:v2p}，\ref{eq:poisson}はコリンの射影法\cite{Chorin}
\item $\bm{V}$，$\bm{A}$は離散ラプラシアン行列を用いて$\nabla^2$を離散化
\item $\bm{W}$，$\bm{Y}$は勾配演算子$\nabla$を離散化
\end{itemize}
\end{block}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}
 \frametitle{研究背景}
   \framesubtitle{先行研究}
\begin{columns}[T]
	\begin{column}{0.6\linewidth}
	\begin{block}{Visual Simulaton of Smoke \cite{fedkiw} [Fedkiw et al. 2001]}
		\begin{itemize}
		\item CGにおいて広く用いられる煙のオフラインシミュレーション手法
		\item 密度を計算した後，ボリュームレンダリングを用いて描画
		\item 計算量は空間解像度に依存
	\end{itemize}
	\end{block}
	
	\begin{block}{計算機実験}
	\begin{itemize}
	\item 解像度$128^3$，$200$フレーム
	\item シミュレーション\text{ms/f}
	\item 圧力項$\bm{p} = \bm{A}^{-1}\bm{b}$は反復回数20回，\text{ms/f}
	\item レンダリング\text{ms/f}
	\end{itemize}
	\end{block}
    	\end{column}
	\begin{column}{0.4\linewidth}
\includemovie[autoplay, label=hikone]{60mm}{60mm}{movies/obstacle_origin.mp4}
    	\end{column}
    \end{columns}
 \end{frame}
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \begin{comment}
\begin{frame}
 \frametitle{研究背景}
    \framesubtitle{先行研究}
   \begin{block}{ボリュームレンダリング}
   \begin{itemize}
 	\item 3次元空間の全てのボクセル値を可視化画像に反映させるレンダリング手法
	\item 透明度を考慮したレンダリングに用いられる
\end{itemize}
\end{block}
\begin{columns}[T]
	\begin{column}{0.6\linewidth}
	\begin{algorithm}[H]
    		\caption{Axis Alined slice-based Volume Rendering}
       	 \label{alg1}
        		\begin{algorithmic}[1]
                        \STATE x，y，z軸の中から，視線方向に近いものを選ぶ
                        \STATE 軸に垂直な平面（スライス）を，アルファブレンディングして描画
                        \[{\rm{I}}_n= \alpha_n c_n + (1-\alpha_n){\rm{I}}_{n-1}\]
                        \[\alpha= 1 - \exp(-\rho\Delta s)\]
            	\end{algorithmic}
	\end{algorithm}
    	\end{column}
	
	\begin{column}{0.4\linewidth}
	\includegraphics[width=\linewidth]{images/slice_base.png}
    	\end{column}
    \end{columns}
 \end{frame}
\end{comment}
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
   \begin{frame}
  \frametitle{部分空間法(subspace method)}
 \subsection{部分空間法}
\begin{block}{部分空間法}
\begin{itemize}
\item 部分空間に射影し，計算負荷を軽減する手法
\item 空間解像度を保ったまま高速化可能
\item 前処理の計算負荷が大きい
\end{itemize}
\end{block}

\begin{block}{概要}
\begin{itemize}
 \item シミュレーションの前処理として，$\bm{A}^{\mathsf T} \bm{A} = \bm{I}$を満たし，$\bm{x} = \bm{A}\bm{\widetilde{x}} $が成り立つような，$n \times r$行列$\bm{A}$を考える
 \[
 \bm{\widetilde{x}} = \bm{A}\bm{x}
 \]
\item $\bm{\widetilde{x}}$を用いてシミュレーションを行い，$\bm{x} = \bm{A}^{T}\bm{\widetilde{x}}$を用いて$\bm{x}$を求める
\item $\bm{\widetilde{u}}$は，流体の非圧縮条件$\nabla\boldsymbol{\cdot}\bm{\widetilde{u}}$ = 0を満たしていなければならない
\end{itemize}
\end{block}
%\includegraphics[width=0.7\linewidth]{images/subspace.png}
 \end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
   \begin{frame}
  \frametitle{部分空間法(subspace method)}
 \subsection{部分空間法}
   \begin{block}{特異値分解を用いた直交基底の計算}
   \begin{itemize}
   \item 既存のシミュレーションの時系列データを$T$個用いて，行列$\bm{A}$を作成する手法
\item 空間解像度を$n$とする．一般に，$n \gg m \gg r$ 
\item 時刻$t$における速度ベクトル$\bm{u_t}$を用いて，$3n\times m$行列$\bm{S}$を定義する
	 \[ \bm{S} = 
        		\begin{bmatrix}
   \bm{u}_0 & \bm{u}_1 &\cdots  & \bm{u}_{m-1}
\end{bmatrix}
\]
\item $\bm{S}$を以下のように特異値分解して得られるユニタリ行列$\bm{U}$を$\bm{A}$とする

\[
\bm{S} = \bm{U} \bm{\Sigma} \bm{V}^{\mathsf T}
\]

先にQR分解を適用し，サイズを小さくすることができる
\end{itemize}
\end{block}

%\includegraphics[width=0.7\linewidth]{images/subspace.png}
 \end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\frametitle{部分空間法の課題}
\subsection{部分空間法の課題}
	\begin{block}{空間計算量}
		一般に，
		\[64^3 \le n \le 1024^3\]
		\[30 \le r \le 150\]
		
   		\begin{itemize}
			\item $n = 256^3$，$r=50$のとき，行列$\bm{A}$のために10GBほど必要
   			\item 削減後の次元の数に制限．$r \le T$
   			\item GPUによる高速化が不可能
		\end{itemize}
	\end{block}

	\begin{block}{計算時間}
 		\begin{itemize}
		\item $n \times m$行列の特異値分解，QR分解の計算量は$O(nm^2)$
	\end{itemize}
	\end{block}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{提案手法}
\begin{frame}
\frametitle{提案手法}

 \end{frame}

  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \begin{frame}
 \frametitle{実験}
%\begin{figure}[htbp]
%\includegraphics[width=140mm]{images/n128_f99_truth.png}
%\caption{$解像度128^3，ground truth，99フレーム目$}
%\label{fig:n128_f99_div4}
%\end{figure}
%\begin{comment}

\begin{columns}
    \begin{column}{0.48\textwidth}
\includemovie[autoplay, label=dev1]{60mm}{60mm}{movies/obstacle_dev1.mp4}
    \end{column}
    \begin{column}{0.48\textwidth}
\includemovie[autoplay, label=dev2]{60mm}{60mm}{movies/obstacle_dev2.mp4}
    \end{column}
\end{columns}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{thebibliography}{99}
\beamertemplatetextbibitems

\bibitem{Chorin}
A. J. Chorin. Numerical solution of the navier-stokes equations. \textit{Mathematics of Computation}, 22(104):745--762, 1968.

\bibitem{projection_base}
A. Treuille, A. Lewis, and Z. Popovi\'{c}. Model reduction for real-time fluids. \textit{ACM Transactions on Graphics}, 25(3):826--834, 2006.

\bibitem{stam}
J. Stam. Stable fluids. In \textit{SIGGRAPH 99 Conference Proceedings, Annual Conference Series}, pages 121--128, 1999.

\bibitem{fedkiw}
R. Fedkiew, J. stam, and H. Jensen. Visual simulation of smoke. In \textit{Proceedings of SIGGRAPH 01}, 15--22, 2001.

\bibitem{subspace}
T. Kim and J. Delaney. Subspace fluid re-simulation. \textit{ACM Transactions on Graphics}, 32(4):62:1--62:9, 2013.


\end{thebibliography}
\end{document}